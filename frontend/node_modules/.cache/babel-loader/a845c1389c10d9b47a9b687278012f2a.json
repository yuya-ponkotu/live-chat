{"ast":null,"code":"// Utilities\nimport { getCurrentInstance, IN_BROWSER, isComponentInstance, propsFactory, SUPPORTS_FOCUS_VISIBLE } from \"../../util/index.mjs\";\nimport { makeDelayProps, useDelay } from \"../../composables/delay.mjs\";\nimport { computed, effectScope, nextTick, onScopeDispose, ref, watch, watchEffect } from 'vue'; // Types\n\nexport const makeActivatorProps = propsFactory({\n  activator: [String, Object],\n  activatorProps: {\n    type: Object,\n    default: () => ({})\n  },\n  openOnClick: {\n    type: Boolean,\n    default: undefined\n  },\n  openOnHover: Boolean,\n  openOnFocus: {\n    type: Boolean,\n    default: undefined\n  },\n  ...makeDelayProps()\n});\nexport function useActivator(props, isActive) {\n  const activatorEl = ref();\n  let isHovered = false;\n  let isFocused = false;\n  const openOnFocus = computed(() => props.openOnFocus || props.openOnFocus == null && props.openOnHover);\n  const openOnClick = computed(() => props.openOnClick || props.openOnClick == null && !props.openOnHover && !openOnFocus.value);\n  const {\n    runOpenDelay,\n    runCloseDelay\n  } = useDelay(props, value => {\n    if (value === (props.openOnHover && isHovered || openOnFocus.value && isFocused)) {\n      isActive.value = value;\n    }\n  });\n  const availableEvents = {\n    click: e => {\n      e.stopPropagation();\n      activatorEl.value = e.currentTarget || e.target;\n      isActive.value = !isActive.value;\n    },\n    mouseenter: e => {\n      isHovered = true;\n      activatorEl.value = e.currentTarget || e.target;\n      runOpenDelay();\n    },\n    mouseleave: e => {\n      isHovered = false;\n      runCloseDelay();\n    },\n    focus: e => {\n      if (SUPPORTS_FOCUS_VISIBLE && !e.target.matches(':focus-visible')) return;\n      isFocused = true;\n      e.stopPropagation();\n      activatorEl.value = e.currentTarget || e.target;\n      runOpenDelay();\n    },\n    blur: e => {\n      isFocused = false;\n      e.stopPropagation();\n      runCloseDelay();\n    }\n  };\n  const activatorEvents = computed(() => {\n    const events = {};\n\n    if (openOnClick.value) {\n      events.click = availableEvents.click;\n    }\n\n    if (props.openOnHover) {\n      events.mouseenter = availableEvents.mouseenter;\n      events.mouseleave = availableEvents.mouseleave;\n    }\n\n    if (openOnFocus.value) {\n      events.focus = availableEvents.focus;\n      events.blur = availableEvents.blur;\n    }\n\n    return events;\n  });\n  const activatorRef = ref();\n  watchEffect(() => {\n    if (!activatorRef.value) return;\n    nextTick(() => {\n      const activator = activatorRef.value;\n      activatorEl.value = isComponentInstance(activator) ? activator.$el : activator;\n    });\n  });\n  const vm = getCurrentInstance('useActivator');\n  let scope;\n  watch(() => !!props.activator, val => {\n    if (val && IN_BROWSER) {\n      scope = effectScope();\n      scope.run(() => {\n        _useActivator(props, vm, {\n          activatorEl,\n          activatorRef,\n          activatorEvents\n        });\n      });\n    } else if (scope) {\n      scope.stop();\n    }\n  }, {\n    flush: 'post',\n    immediate: true\n  });\n  return {\n    activatorEl,\n    activatorRef,\n    activatorEvents\n  };\n}\n\nfunction _useActivator(props, vm, _ref) {\n  let {\n    activatorEl,\n    activatorEvents\n  } = _ref;\n  watch(() => props.activator, (val, oldVal) => {\n    if (oldVal && val !== oldVal) {\n      const activator = getActivator(oldVal);\n      activator && unbindActivatorProps(activator);\n    }\n\n    if (val) {\n      nextTick(() => bindActivatorProps());\n    }\n  }, {\n    immediate: true\n  });\n  watch(() => props.activatorProps, () => {\n    bindActivatorProps();\n  });\n  onScopeDispose(() => {\n    unbindActivatorProps();\n  });\n\n  function bindActivatorProps() {\n    let el = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getActivator();\n\n    let _props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : props.activatorProps;\n\n    if (!el) return;\n    Object.entries(activatorEvents.value).forEach(_ref2 => {\n      let [name, cb] = _ref2;\n      el.addEventListener(name, cb);\n    });\n    Object.keys(_props).forEach(k => {\n      if (_props[k] == null) {\n        el.removeAttribute(k);\n      } else {\n        el.setAttribute(k, _props[k]);\n      }\n    });\n  }\n\n  function unbindActivatorProps() {\n    let el = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getActivator();\n\n    let _props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : props.activatorProps;\n\n    if (!el) return;\n    Object.entries(activatorEvents.value).forEach(_ref3 => {\n      let [name, cb] = _ref3;\n      el.removeEventListener(name, cb);\n    });\n    Object.keys(_props).forEach(k => {\n      el.removeAttribute(k);\n    });\n  }\n\n  function getActivator() {\n    var _activator;\n\n    let selector = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : props.activator;\n    let activator;\n\n    if (selector) {\n      if (selector === 'parent') {\n        var _vm$proxy, _vm$proxy$$el;\n\n        activator = vm == null ? void 0 : (_vm$proxy = vm.proxy) == null ? void 0 : (_vm$proxy$$el = _vm$proxy.$el) == null ? void 0 : _vm$proxy$$el.parentNode;\n      } else if (typeof selector === 'string') {\n        // Selector\n        activator = document.querySelector(selector);\n      } else if ('$el' in selector) {\n        // Component (ref)\n        activator = selector.$el;\n      } else {\n        // HTMLElement | Element\n        activator = selector;\n      }\n    } // The activator should only be a valid element (Ignore comments and text nodes)\n\n\n    activatorEl.value = ((_activator = activator) == null ? void 0 : _activator.nodeType) === Node.ELEMENT_NODE ? activator : null;\n    return activatorEl.value;\n  }\n}","map":{"version":3,"mappings":"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","names":["getCurrentInstance","IN_BROWSER","isComponentInstance","propsFactory","SUPPORTS_FOCUS_VISIBLE","makeDelayProps","useDelay","computed","effectScope","nextTick","onScopeDispose","ref","watch","watchEffect","makeActivatorProps","activator","String","Object","activatorProps","type","default","openOnClick","Boolean","undefined","openOnHover","openOnFocus","useActivator","props","isActive","activatorEl","isHovered","isFocused","value","runOpenDelay","runCloseDelay","availableEvents","click","e","stopPropagation","currentTarget","target","mouseenter","mouseleave","focus","matches","blur","activatorEvents","events","activatorRef","$el","vm","scope","val","run","_useActivator","stop","flush","immediate","_ref","oldVal","getActivator","unbindActivatorProps","bindActivatorProps","el","_props","entries","forEach","_ref2","name","cb","addEventListener","keys","k","removeAttribute","setAttribute","_ref3","removeEventListener","selector","proxy","_vm$proxy","_vm$proxy$$el","parentNode","document","querySelector","nodeType","Node","ELEMENT_NODE"],"sources":["../../../src/components/VOverlay/useActivator.tsx"],"sourcesContent":["// Utilities\nimport { getCurrentInstance, IN_BROWSER, isComponentInstance, propsFactory, SUPPORTS_FOCUS_VISIBLE } from '@/util'\nimport { makeDelayProps, useDelay } from '@/composables/delay'\nimport {\n  computed,\n  effectScope,\n  nextTick,\n  onScopeDispose,\n  ref,\n  watch,\n  watchEffect,\n} from 'vue'\n\n// Types\nimport type { DelayProps } from '@/composables/delay'\nimport type {\n  ComponentInternalInstance,\n  ComponentPublicInstance,\n  EffectScope,\n  PropType,\n\n  Ref,\n} from 'vue'\n\ninterface ActivatorProps extends DelayProps {\n  activator?: 'parent' | string | Element | ComponentPublicInstance\n  activatorProps: Record<string, any>\n\n  openOnClick: boolean | undefined\n  openOnHover: boolean\n  openOnFocus: boolean | undefined\n}\n\nexport const makeActivatorProps = propsFactory({\n  activator: [String, Object] as PropType<ActivatorProps['activator']>,\n  activatorProps: {\n    type: Object as PropType<ActivatorProps['activatorProps']>,\n    default: () => ({}),\n  },\n\n  openOnClick: {\n    type: Boolean,\n    default: undefined,\n  },\n  openOnHover: Boolean,\n  openOnFocus: {\n    type: Boolean,\n    default: undefined,\n  },\n\n  ...makeDelayProps(),\n})\n\nexport function useActivator (\n  props: ActivatorProps,\n  isActive: Ref<boolean>\n) {\n  const activatorEl = ref<HTMLElement>()\n\n  let isHovered = false\n  let isFocused = false\n\n  const openOnFocus = computed(() => props.openOnFocus || (props.openOnFocus == null && props.openOnHover))\n  const openOnClick = computed(() => props.openOnClick || (props.openOnClick == null && !props.openOnHover && !openOnFocus.value))\n\n  const { runOpenDelay, runCloseDelay } = useDelay(props, value => {\n    if (value === (\n      (props.openOnHover && isHovered) ||\n      (openOnFocus.value && isFocused)\n    )) {\n      isActive.value = value\n    }\n  })\n\n  const availableEvents = {\n    click: (e: MouseEvent) => {\n      e.stopPropagation()\n      activatorEl.value = (e.currentTarget || e.target) as HTMLElement\n      isActive.value = !isActive.value\n    },\n    mouseenter: (e: MouseEvent) => {\n      isHovered = true\n      activatorEl.value = (e.currentTarget || e.target) as HTMLElement\n      runOpenDelay()\n    },\n    mouseleave: (e: MouseEvent) => {\n      isHovered = false\n      runCloseDelay()\n    },\n    focus: (e: FocusEvent) => {\n      if (\n        SUPPORTS_FOCUS_VISIBLE &&\n        !(e.target as HTMLElement).matches(':focus-visible')\n      ) return\n\n      isFocused = true\n      e.stopPropagation()\n      activatorEl.value = (e.currentTarget || e.target) as HTMLElement\n\n      runOpenDelay()\n    },\n    blur: (e: FocusEvent) => {\n      isFocused = false\n      e.stopPropagation()\n\n      runCloseDelay()\n    },\n  }\n\n  const activatorEvents = computed(() => {\n    const events: Partial<typeof availableEvents> = {}\n\n    if (openOnClick.value) {\n      events.click = availableEvents.click\n    }\n    if (props.openOnHover) {\n      events.mouseenter = availableEvents.mouseenter\n      events.mouseleave = availableEvents.mouseleave\n    }\n    if (openOnFocus.value) {\n      events.focus = availableEvents.focus\n      events.blur = availableEvents.blur\n    }\n\n    return events\n  })\n\n  const activatorRef = ref()\n  watchEffect(() => {\n    if (!activatorRef.value) return\n\n    nextTick(() => {\n      const activator = activatorRef.value\n      activatorEl.value = isComponentInstance(activator) ? activator.$el : activator\n    })\n  })\n\n  const vm = getCurrentInstance('useActivator')\n  let scope: EffectScope\n  watch(() => !!props.activator, val => {\n    if (val && IN_BROWSER) {\n      scope = effectScope()\n      scope.run(() => {\n        _useActivator(props, vm, { activatorEl, activatorRef, activatorEvents })\n      })\n    } else if (scope) {\n      scope.stop()\n    }\n  }, { flush: 'post', immediate: true })\n\n  return { activatorEl, activatorRef, activatorEvents }\n}\n\nfunction _useActivator (\n  props: ActivatorProps,\n  vm: ComponentInternalInstance,\n  { activatorEl, activatorEvents }: ReturnType<typeof useActivator>\n) {\n  watch(() => props.activator, (val, oldVal) => {\n    if (oldVal && val !== oldVal) {\n      const activator = getActivator(oldVal)\n      activator && unbindActivatorProps(activator)\n    }\n    if (val) {\n      nextTick(() => bindActivatorProps())\n    }\n  }, { immediate: true })\n\n  watch(() => props.activatorProps, () => {\n    bindActivatorProps()\n  })\n\n  onScopeDispose(() => {\n    unbindActivatorProps()\n  })\n\n  function bindActivatorProps (el = getActivator(), _props = props.activatorProps) {\n    if (!el) return\n\n    Object.entries(activatorEvents.value).forEach(([name, cb]) => {\n      el.addEventListener(name, cb as (e: Event) => void)\n    })\n\n    Object.keys(_props).forEach(k => {\n      if (_props[k] == null) {\n        el.removeAttribute(k)\n      } else {\n        el.setAttribute(k, _props[k])\n      }\n    })\n  }\n\n  function unbindActivatorProps (el = getActivator(), _props = props.activatorProps) {\n    if (!el) return\n\n    Object.entries(activatorEvents.value).forEach(([name, cb]) => {\n      el.removeEventListener(name, cb as (e: Event) => void)\n    })\n\n    Object.keys(_props).forEach(k => {\n      el.removeAttribute(k)\n    })\n  }\n\n  function getActivator (selector = props.activator): HTMLElement | undefined {\n    let activator\n    if (selector) {\n      if (selector === 'parent') {\n        activator = vm?.proxy?.$el?.parentNode\n      } else if (typeof selector === 'string') {\n        // Selector\n        activator = document.querySelector(selector)\n      } else if ('$el' in selector) {\n        // Component (ref)\n        activator = selector.$el\n      } else {\n        // HTMLElement | Element\n        activator = selector\n      }\n    }\n\n    // The activator should only be a valid element (Ignore comments and text nodes)\n    activatorEl.value = activator?.nodeType === Node.ELEMENT_NODE ? activator : null\n\n    return activatorEl.value\n  }\n}\n"]},"metadata":{},"sourceType":"module"}